(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Ball, Coord, Game, Player, game;

console.log('hello phaser');

Coord = (function() {
  function Coord(x, y) {
    this.x = x;
    this.y = y;
  }

  return Coord;

})();

Player = (function() {
  function Player(game, id, avatar) {
    this.game = game;
    this.id = id;
    this.avatar = avatar;
    this.bucket = this.game.plateforms.create(0, 0, 'ground');
    this.bucket.playerParent = this;
    this.bucket.enableBody = true;
    this.bucket.scale.setTo(0.3, 2);
    this.bucket.body.immovable = true;
    this.score = 0;
    this.scoreText = null;
  }

  Player.prototype.captureBall = function(ball) {
    ball.kill();
    this.score += 10;
    return this.displayScore();
  };

  Player.prototype.displayScore = function() {
    return this.scoreText.setText("player " + this.id + ": " + this.score);
  };

  return Player;

})();

Ball = (function() {
  function Ball(balls, coord, score, type) {
    var star;
    this.balls = balls;
    this.coord = coord;
    this.score = score;
    this.type = type;
    star = this.balls.create(this.coord, 0, 'star');
    star.body.gravity.y = 500;
    star.body.bounce.y = 0.7;
  }

  return Ball;

})();

Game = (function() {
  var GameStatus;

  GameStatus = {
    INIT: 1,
    RUNNING: 2,
    SCORE: 3
  };

  function Game(status, players) {
    var self;
    this.status = status;
    this.players = players;
    this.balls = null;
    this.plateforms = null;
    this.players = [];
    self = this;
    this.phaser = new Phaser.Game(1200, 680, Phaser.AUTO, '', {
      preload: (function() {
        return self.preload();
      }),
      create: (function() {
        return self.create();
      }),
      update: (function() {
        return self.update();
      }),
      render: (function() {
        return self.render();
      })
    });
    this.socket = io.connect('http://vader.mapado.com');
  }

  Game.prototype.generate_fake_player = function() {
    var i, x, y, _i, _results;
    x = y = 0;
    _results = [];
    for (i = _i = 0; _i <= 4; i = ++_i) {
      _results.push(this.players.push(new Player(this, i, null)));
    }
    return _results;
  };

  Game.prototype.generate_fake_balls = function() {
    var i, rd, _i, _results;
    _results = [];
    for (i = _i = 0; _i <= 12; i = ++_i) {
      rd = Math.random();
      if (0.95 < rd) {
        _results.push(new Ball(this.balls, i * 80, 10, 'facecat'));
      } else {
        _results.push(void 0);
      }
    }
    return _results;
  };

  Game.prototype.set_players_position = function() {
    var max_space_player, nbr_player, player, pointer, _i, _len, _ref, _results;
    nbr_player = this.players.length;
    max_space_player = this.phaser.width / (nbr_player + 1);
    _ref = this.players;
    _results = [];
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      player = _ref[_i];
      player.bucket.width = max_space_player - 10;
      pointer = max_space_player + player.id * max_space_player - (max_space_player / 2);
      player.bucket.x = max_space_player + player.id * max_space_player - (max_space_player / 2);
      player.bucket.y = this.phaser.world.height - 64;
      _results.push(player.scoreText = this.phaser.add.text(pointer, 16, '', {
        font: '32px arial',
        fill: '#fff'
      }));
    }
    return _results;
  };

  Game.prototype.preload = function() {
    console.log(':preload');
    this.phaser.load.image('sky', '/assets/images/sky.png');
    this.phaser.load.image('ground', '/assets/images/platform.png');
    return this.phaser.load.image('star', '/assets/images/star.png');
  };

  Game.prototype.create = function() {
    console.log(':create');
    this.phaser.add.sprite(0, 0, 'sky');
    this.plateforms = this.phaser.add.group();
    this.plateforms.enableBody = true;
    this.generate_fake_player();
    this.set_players_position();
    this.balls = this.phaser.add.group();
    this.balls.enableBody = true;
    this.new_line = new Phaser.Line(0, 0, 0, 0);
    return this.phaser.input.onDown.add(this.click, this);
  };

  Game.prototype.collectBalls = function(plateform, ball) {
    return plateform.playerParent.captureBall(ball);
  };

  Game.prototype.update = function() {
    this.phaser.physics.arcade.overlap(this.plateforms, this.balls, this.collectBalls, null, this);
    this.phaser.physics.arcade.collide(this.balls, this.new_line);
    if (this.dragging) {
      if (this.phaser.input.activePointer.isDown) {
        return this.new_line.end.set(this.phaser.input.activePointer.x, this.phaser.input.activePointer.y);
      } else {
        this.dragging = false;
        return console.log('push line !');
      }
    }
  };

  Game.prototype.render = function() {
    this.phaser.debug.geom(this.new_line);
    return this.phaser.debug.rectangle(this.new_line);
  };

  Game.prototype.click = function(pointer) {
    this.dragging = true;
    return this.new_line.start.set(pointer.x, pointer.y);
  };

  return Game;

})();

game = new Game();


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvaG9tZS9lcGkvQnVyZWF1L1NhdmVUaGVJbnRlcm5ldC9jbGllbnQvbm9kZV9tb2R1bGVzL2d1bHAtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL2hvbWUvZXBpL0J1cmVhdS9TYXZlVGhlSW50ZXJuZXQvY2xpZW50L3NjcmlwdHMvY29mZmVlL2FwcC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxJQUFBLCtCQUFBOztBQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksY0FBWixDQUFBLENBQUE7O0FBQUE7QUFLaUIsRUFBQSxlQUFFLENBQUYsRUFBTSxDQUFOLEdBQUE7QUFBVSxJQUFULElBQUMsQ0FBQSxJQUFBLENBQVEsQ0FBQTtBQUFBLElBQUwsSUFBQyxDQUFBLElBQUEsQ0FBSSxDQUFWO0VBQUEsQ0FBYjs7ZUFBQTs7SUFMSixDQUFBOztBQUFBO0FBUWlCLEVBQUEsZ0JBQUUsSUFBRixFQUFTLEVBQVQsRUFBYyxNQUFkLEdBQUE7QUFDVCxJQURVLElBQUMsQ0FBQSxPQUFBLElBQ1gsQ0FBQTtBQUFBLElBRGlCLElBQUMsQ0FBQSxLQUFBLEVBQ2xCLENBQUE7QUFBQSxJQURzQixJQUFDLENBQUEsU0FBQSxNQUN2QixDQUFBO0FBQUEsSUFBQSxJQUFDLENBQUEsTUFBRCxHQUFVLElBQUMsQ0FBQSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQWpCLENBQXdCLENBQXhCLEVBQTJCLENBQTNCLEVBQThCLFFBQTlCLENBQVYsQ0FBQTtBQUFBLElBQ0EsSUFBQyxDQUFBLE1BQU0sQ0FBQyxZQUFSLEdBQXVCLElBRHZCLENBQUE7QUFBQSxJQUVBLElBQUMsQ0FBQSxNQUFNLENBQUMsVUFBUixHQUFxQixJQUZyQixDQUFBO0FBQUEsSUFHQSxJQUFDLENBQUEsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFkLENBQW9C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dkMsRUFGSztFQUFBLENBakdQLENBQUE7O2NBQUE7O0lBakNKLENBQUE7O0FBQUEsSUFzSUEsR0FBVyxJQUFBLElBQUEsQ0FBQSxDQXRJWCxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjb25zb2xlLmxvZyAnaGVsbG8gcGhhc2VyJ1xuXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuY2xhc3MgQ29vcmRcbiAgICBjb25zdHJ1Y3RvcjogKEB4LCBAeSkgLT5cblxuY2xhc3MgUGxheWVyXG4gICAgY29uc3RydWN0b3I6IChAZ2FtZSwgQGlkLCBAYXZhdGFyKSAtPlxuICAgICAgICBAYnVja2V0ID0gQGdhbWUucGxhdGVmb3Jtcy5jcmVhdGUgMCwgMCwgJ2dyb3VuZCdcbiAgICAgICAgQGJ1Y2tldC5wbGF5ZXJQYXJlbnQgPSB0aGlzXG4gICAgICAgIEBidWNrZXQuZW5hYmxlQm9keSA9IHRydWVcbiAgICAgICAgQGJ1Y2tldC5zY2FsZS5zZXRUbyAwLjMsIDJcbiAgICAgICAgQGJ1Y2tldC5ib2R5LmltbW92YWJsZSA9IHRydWVcbiAgICAgICAgQHNjb3JlID0gMFxuICAgICAgICBAc2NvcmVUZXh0ID0gbnVsbFxuXG4gICAgY2FwdHVyZUJhbGw6IChiYWxsKSAtPlxuICAgICAgICBiYWxsLmtpbGwoKVxuICAgICAgICBAc2NvcmUgKz0gMTBcbiAgICAgICAgQGRpc3BsYXlTY29yZSgpXG5cbiAgICBkaXNwbGF5U2NvcmU6ICgpIC0+XG4gICAgICAgIEBzY29yZVRleHQuc2V0VGV4dCBcInBsYXllciAje0BpZH06ICN7QHNjb3JlfVwiXG5cbmNsYXNzIEJhbGxcbiAgICBjb25zdHJ1Y3RvcjogKEBiYWxscywgQGNvb3JkLCBAc2NvcmUsIEB0eXBlKSAtPlxuICAgICAgICBzdGFyID0gQGJhbGxzLmNyZWF0ZSBAY29vcmQsIDAsICdzdGFyJ1xuICAgICAgICBzdGFyLmJvZHkuZ3Jhdml0eS55ID0gNTAwXG4gICAgICAgIHN0YXIuYm9keS5ib3VuY2UueSA9IDAuN1xuXG5cbmNsYXNzIEdhbWVcbiAgICBHYW1lU3RhdHVzID1cbiAgICAgICAgSU5JVCA6IDFcbiAgICAgICAgUlVOTklORyA6IDJcbiAgICAgICAgU0NPUkUgOiAzXG5cbiAgICBjb25zdHJ1Y3RvcjogKEBzdGF0dXMsIEBwbGF5ZXJzKSAtPlxuICAgICAgICAjIGJhc2ljIGNvbmZpZ1xuICAgICAgICBAYmFsbHMgPSBudWxsXG4gICAgICAgIEBwbGF0ZWZvcm1zID0gbnVsbFxuICAgICAgICBAcGxheWVycyA9IFtdXG4gICAgICAgICMgR2VuZXJhdGUgdGhlIHdvcmRcbiAgICAgICAgc2VsZiA9IHRoaXNcbiAgICAgICAgQHBoYXNlciA9IG5ldyBQaGFzZXIuR2FtZShcbiAgICAgICAgICAgIDEyMDAsXG4gICAgICAgICAgICA2ODAsXG4gICAgICAgICAgICBQaGFzZXIuQVVUTyxcbiAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgcHJlbG9hZDooIC0+IHNlbGYucHJlbG9hZCgpKSxcbiAgICAgICAgICAgIGNyZWF0ZTogKCAtPiBzZWxmLmNyZWF0ZSgpKSxcbiAgICAgICAgICAgIHVwZGF0ZTogKC0+IHNlbGYudXBkYXRlKCkpLFxuICAgICAgICAgICAgcmVuZGVyOiAoLT4gc2VsZi5yZW5kZXIoKSlcbiAgICAgICAgKVxuXG4gICAgICAgIEBzb2NrZXQgPSBpby5jb25uZWN0ICdodHRwOi8vdmFkZXIubWFwYWRvLmNvbSdcbiAgICAgICAgI0Bzb2NrZXQub24oJ3dlbGNvbWUnLCAgKChkYXRhKSAtPiBjb25zb2xlLmxvZyBkYXRhKSlcbiAgICAgICAgI0Bzb2NrZXQub24oJ25ldyBwbGF5ZXInLCAoKGRhdGEpIC0+IGNvbnNvbGUubG9nIGRhdGEpKVxuICAgICAgICAjQHNvY2tldC5vbignY2hhcmFjdGVyIHNwYXduZWQnLCAoKGRhdGEpIC0+IGNvbnNvbGUubG9nIGRhdGEpKVxuICAgICAgICAjQHNvY2tldC5vbignZ2FtZSBzdG9wJywgKC0+IGNvbnNvbGUubG9nIFwiR0FNRSBTVE9QXCIgKSlcblxuICAgIGdlbmVyYXRlX2Zha2VfcGxheWVyOiAoKSAtPlxuICAgICAgICB4ID0geSA9IDBcbiAgICAgICAgZm9yIGkgaW4gWzAuLjRdXG4gICAgICAgICAgICBAcGxheWVycy5wdXNoKG5ldyBQbGF5ZXIodGhpcywgaSwgbnVsbCkpXG5cbiAgICBnZW5lcmF0ZV9mYWtlX2JhbGxzOiAoKSAtPlxuICAgICAgICBmb3IgaSBpbiBbMC4uMTJdXG4gICAgICAgICAgICByZCA9IE1hdGgucmFuZG9tKClcbiAgICAgICAgICAgIGlmIDAuOTUgIDwgcmRcbiAgICAgICAgICAgICAgICBuZXcgQmFsbChAYmFsbHMsIGkqODAsIDEwLCAnZmFjZWNhdCcpXG5cbiAgICBzZXRfcGxheWVyc19wb3NpdGlvbjogKCkgLT5cbiAgICAgICAgbmJyX3BsYXllciA9IEBwbGF5ZXJzLmxlbmd0aFxuICAgICAgICBtYXhfc3BhY2VfcGxheWVyID0gQHBoYXNlci53aWR0aCAvIChuYnJfcGxheWVyICsgMSlcbiAgICAgICAgZm9yIHBsYXllciAgaW4gQHBsYXllcnNcbiAgICAgICAgICAgIHBsYXllci5idWNrZXQud2lkdGggPSBtYXhfc3BhY2VfcGxheWVyIC0gMTBcbiAgICAgICAgICAgIHBvaW50ZXIgPSBtYXhfc3BhY2VfcGxheWVyICsgcGxheWVyLmlkICogbWF4X3NwYWNlX3BsYXllciAtIChtYXhfc3BhY2VfcGxheWVyIC8gMilcbiAgICAgICAgICAgIHBsYXllci5idWNrZXQueCA9ICBtYXhfc3BhY2VfcGxheWVyICsgcGxheWVyLmlkICogbWF4X3NwYWNlX3BsYXllciAtIChtYXhfc3BhY2VfcGxheWVyIC8gMilcbiAgICAgICAgICAgIHBsYXllci5idWNrZXQueSA9ICBAcGhhc2VyLndvcmxkLmhlaWdodCAtIDY0XG4gICAgICAgICAgICBwbGF5ZXIuc2NvcmVUZXh0ID0gQHBoYXNlci5hZGQudGV4dCBwb2ludGVyLCAxNiwgJycsIGZvbnQ6ICczMnB4IGFyaWFsJywgZmlsbDogJyNmZmYnXG5cblxuICAgIHByZWxvYWQ6ICgpIC0+XG4gICAgICBjb25zb2xlLmxvZyAnOnByZWxvYWQnXG4gICAgICBAcGhhc2VyLmxvYWQuaW1hZ2UgJ3NreScsICcvYXNzZXRzL2ltYWdlcy9za3kucG5nJ1xuICAgICAgQHBoYXNlci5sb2FkLmltYWdlICdncm91bmQnLCAnL2Fzc2V0cy9pbWFnZXMvcGxhdGZvcm0ucG5nJ1xuICAgICAgQHBoYXNlci5sb2FkLmltYWdlICdzdGFyJywgJy9hc3NldHMvaW1hZ2VzL3N0YXIucG5nJ1xuXG4gICAgY3JlYXRlOiAoKSAtPlxuICAgICAgY29uc29sZS5sb2cgJzpjcmVhdGUnXG4gICAgICBAcGhhc2VyLmFkZC5zcHJpdGUgMCwgMCwgJ3NreSdcblxuICAgICAgQHBsYXRlZm9ybXMgPSBAcGhhc2VyLmFkZC5ncm91cCgpXG4gICAgICBAcGxhdGVmb3Jtcy5lbmFibGVCb2R5ID0gdHJ1ZVxuXG4gICAgICBAZ2VuZXJhdGVfZmFrZV9wbGF5ZXIoKVxuXG4gICAgICBAc2V0X3BsYXllcnNfcG9zaXRpb24oKVxuXG4gICAgICAjY3Vyc29ycyA9IEBwaGFzZXIuaW5wdXQua2V5Ym9hcmQuY3JlYXRlQ3Vyc29yS2V5cygpXG4gICAgICBAYmFsbHMgPSBAcGhhc2VyLmFkZC5ncm91cCgpXG4gICAgICBAYmFsbHMuZW5hYmxlQm9keSA9IHRydWVcblxuICAgICAgQG5ld19saW5lID0gbmV3IFBoYXNlci5MaW5lIDAsIDAsIDAsIDBcbiAgICAgIEBwaGFzZXIuaW5wdXQub25Eb3duLmFkZChAY2xpY2ssIHRoaXMpXG5cblxuICAgIGNvbGxlY3RCYWxsczogKHBsYXRlZm9ybSwgYmFsbCkgLT5cbiAgICAgIHBsYXRlZm9ybS5wbGF5ZXJQYXJlbnQuY2FwdHVyZUJhbGwoYmFsbClcblxuICAgIHVwZGF0ZTogKCkgLT5cbiAgICAgIEBwaGFzZXIucGh5c2ljcy5hcmNhZGUub3ZlcmxhcCBAcGxhdGVmb3JtcywgQGJhbGxzLCBAY29sbGVjdEJhbGxzLCBudWxsLCB0aGlzXG4gICAgICBAcGhhc2VyLnBoeXNpY3MuYXJjYWRlLmNvbGxpZGUgQGJhbGxzLCBAbmV3X2xpbmVcblxuICAgICAgI0BnZW5lcmF0ZV9mYWtlX2JhbGxzKClcblxuICAgICAgaWYgQGRyYWdnaW5nXG4gICAgICAgICAgaWYgQHBoYXNlci5pbnB1dC5hY3RpdmVQb2ludGVyLmlzRG93blxuICAgICAgICAgICAgQG5ld19saW5lLmVuZC5zZXQgQHBoYXNlci5pbnB1dC5hY3RpdmVQb2ludGVyLngsIEBwaGFzZXIuaW5wdXQuYWN0aXZlUG9pbnRlci55XG5cbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICBAZHJhZ2dpbmcgPSBmYWxzZVxuICAgICAgICAgICAgY29uc29sZS5sb2cgJ3B1c2ggbGluZSAhJ1xuXG4gICAgcmVuZGVyOiAoKSAtPlxuICAgICAgQHBoYXNlci5kZWJ1Zy5nZW9tIEBuZXdfbGluZVxuICAgICAgQHBoYXNlci5kZWJ1Zy5yZWN0YW5nbGUgQG5ld19saW5lXG5cbiAgICBjbGljazogKHBvaW50ZXIpIC0+XG4gICAgICBAZHJhZ2dpbmcgPSB0cnVlXG4gICAgICBAbmV3X2xpbmUuc3RhcnQuc2V0IHBvaW50ZXIueCwgcG9pbnRlci55XG5cbmdhbWUgPSBuZXcgR2FtZSgpXG4iXX0=
